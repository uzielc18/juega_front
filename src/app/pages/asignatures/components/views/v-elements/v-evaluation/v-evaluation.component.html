<div [nbSpinner]="loading" nbSpinnerStatus="primary" nbSpinnerSize="large">
  <div class="work work-expired" style="margin-left: 20px; margin-right: 20px;"
       *ngIf="tiempo_vencido && rolSemestre?.rol?.name === 'Estudiante' && pending?.justification?.length <= 0 && pending?.student_pending?.realizo === '0'">
    <span>
      <p>Hola {{ userInfo.name }}!</p>, Lo sentimos, su actividad de evaluación: {{ element?.titulo }} acaba de caducar hace {{
      expiredDays |
        i18nPlural:daysMap }} {{ expiredHours | i18nPlural:hoursMap }} {{ expiredMinutes | i18nPlural:minutesMap }} {{
      expiredSeconds | i18nPlural:secondsMap }}
    </span>
    <div class="ms-auto d-flex align-items-center">
      <button class="d-flex align-items-center mx-3 py-1 work-expired-button" (click)="justifications()">
        <nb-icon class="me-2" icon="info"></nb-icon>
        <span>Solicitar apertura</span>
      </button>
      <!-- <nb-icon class="work-expired-close" icon="close-outline"></nb-icon> -->
    </div>
  </div>
  <div class="work work-vence" style="margin-left: 20px; margin-right: 20px;"
       *ngIf="!tiempo_vencido && rolSemestre?.rol?.name === 'Estudiante' && pending?.student_pending?.nota === null && pending?.student_pending?.realizo === '0'">
      <span>
          <p>Hola {{ userInfo.name }}!</p>, su evaluación: {{ element?.titulo }} vence en: {{
        venceDays |
          i18nPlural:daysMap }} {{ venceHours | i18nPlural:hoursMap }} {{ venceMinutes | i18nPlural:minutesMap }} {{
        venceSeconds | i18nPlural:secondsMap }}
        </span>
  </div>
  <div class="work work-evaluated" style="margin-left: 20px; margin-right: 20px;"
       *ngIf="rolSemestre?.rol?.name === 'Estudiante' && !pending?.student_pending?.realizo && !pending?.student_pending?.nota">
    <p>Hola {{ userInfo.name }}!,</p><span>Tu evaluación: {{ element?.titulo }} ya fué calificado</span>
  </div>
  <div class="work work-evaluated" style="margin-left: 20px; margin-right: 20px;"
       *ngIf="rolSemestre?.rol?.name === 'Estudiante' && !pending?.student_pending?.realizo && !pending?.student_pending?.nota">
    <p>Felicitaciones {{ userInfo.name }}!,</p><span>Ya entregaste tu evaluación ({{ element?.titulo }})</span>
  </div>
  <nb-card class="instructions-container" style="margin-left: 20px; margin-right: 20px;">
    <nb-card-body>
      <div class="row">
        <div class="instructions  col-md-9 col-xxl-10">
          <!-- <h4 class="instructions-title">{{ element?.titulo }}</h4> -->
          <p class="instructions-description">{{ element?.descripcion }}</p>
        </div>
        <div class="col-md-3 col-xxl-2 pe-0">
          <div class="calification calification-evalue ms-auto"
               *ngIf="['Docente', 'Admin'].includes(rolSemestre?.rol?.name)"
               (click)="calificar(element)">
            <nb-icon icon="edit"></nb-icon>
            <span>Calificar</span>
          </div>

          <div class="calification ms-auto"
               *ngIf="rolSemestre?.rol?.name === 'Estudiante' && !pending?.student_pending?.nota">
            Aún no tiene calificación
          </div>
          <div class="calification calification-evaluated"
               *ngIf="rolSemestre?.rol?.name === 'Estudiante' && pending?.student_pending?.nota">
            <p>{{pending?.student_pending?.nota}}</p>
            <span>Calificación</span>
          </div>
        </div>
        <div class="comentario-style" *ngIf="rolSemestre?.rol?.name === 'Estudiante' && pending?.student_pending?.comentario_docente">
          <span style="font-size: 12px"><small class="label">Comentario del docente: </small>
            <small class="label"> {{pending?.student_pending?.comentario_docente}}</small></span>
        </div>
      </div>
      <hr>
      <div class="row">
        <div class="col-md-2"></div>
        <div class="col-md-8">
          <nb-card status="primary">
            <nb-card-header class="text-center" style="padding-top: 8px; padding-bottom: 8px;">
              INFORMACIÓN DE LA EVALUACIÓN
            </nb-card-header>
            <nb-card-body>
            <span
              *ngIf="element?.type_element?.codigo === 'EVAL' && pending?.student_pending && rolSemestre?.rol?.name === 'Estudiante'">
              <nb-alert status="success" class="text-center" *ngIf="pending?.student_pending?.realizo === '1'"
                        style="padding: 3px;">
                EXAMEN FINALIZADO
              </nb-alert>
            </span>
              <div class="table-responsive" style="padding-top: 0px;">
                <table class="table table-sm">
                  <tbody style="font-size: 11px;">
                  <tr>
                    <th>* Duración del examen :</th>
                    <th>{{pending?.duracion}} minutos</th>
                  </tr>
                  <tr>
                    <th>* N° de preguntas :</th>
                    <th>{{element?.exam?.aleatorio === '0' ? pending?.validaciones?.preguntas_count : element?.exam?.aleatorio}}</th>
                  </tr>
                  <tr>
                    <th>* Fecha y hora inicio :</th>
                    <th>{{pending?.student_pending?.fecha_inicio}}</th>
                  </tr>
                  <tr>
                    <th>* Fecha y hora fin :</th>
                    <th>{{pending?.student_pending?.fecha_fin}}</th>
                  </tr>
                  <tr *ngIf="pending?.student_pending?.exam_estudent !== null" style="color: var(--color-warning-500)">
                    <th>* Usted inicio su evaluación:</th>
                    <th>{{pending?.student_pending?.exam_estudent?.fecha_inicio}}</th>
                  </tr>
                  <tr *ngIf="pending?.student_pending?.exam_estudent !== null && pending?.student_pending?.exam_estudent?.fecha_fin === null && !validateDurationExam" style="color: var(--color-warning-500)">
                    <th>* Minutos transcurridos:</th>
                    <th>{{elapsedMinutes | i18nPlural:minutesMap}}</th>
                  </tr>
                  </tbody>
                </table>
              </div>
              <div>
                <nb-alert outline="primary" style="padding: 2px; font-size: 12px;">
                  - {{element?.exam?.mostrar_respuestas === 'SI' ? 'Si' : 'No'}} se mostrara las respuestas al finalizar
                  el examen.
                  <hr style="padding: 0px;">
                  - {{element?.exam?.mostrar_nota === 'SI' ? 'Si' : 'No'}} se mostrara la nota al finalizar el examen.
                </nb-alert>
              </div>

            </nb-card-body>
            <nb-card-footer class="text-center">
              <div *ngIf="pending?.exam?.supervisado === '0' || pending?.exam?.supervisado === null">
                <div
                  *ngIf="rolSemestre?.rol?.name === 'Estudiante' && pending && pending?.validaciones?.bloqueo === 0 && pending?.student_pending?.realizo !== '1'">
                  <span *ngIf="!pending?.student_pending?.exam_estudent && ValidateDateI === true && !tiempo_vencido" class="text-center" style="color: var(--color-danger-500); font-size: 11px;padding: 0px;"><strong class="text-center">¿Estás seguro de iniciar el examen?</strong><br>
                  <label class="text-center">Si su respuesta es “sí”, ya no habrá oportunidad de volver a realizar este examen.</label>
                  </span>
                  <span *ngIf="pending?.student_pending?.exam_estudent && ValidateDateI === true && !tiempo_vencido && validateDurationExam" class="text-center" style="color: var(--color-danger-500); font-size: 16px;padding: 0px;">
                    <strong class="text-center">El tiempo para realizar tu evaluación ha culminado y comunícate con tu docente.</strong><br>
                  </span>
                  <br><br>
                  <button *ngIf="pending?.student_pending?.exam_estudent === null && ValidateDateI === true && !tiempo_vencido" nbButton size="small" status="primary"
                          (click)="initEvaluations()">Iniciar evaluación
                  </button>
                  <button *ngIf="pending?.student_pending?.exam_estudent && !validateDurationExam" nbButton size="small" status="primary"
                          (click)="backQuestions()">Volver a la evaluación
                  </button>
                </div>
                <div
                  *ngIf="rolSemestre?.rol?.name === 'Estudiante' && pending && pending?.student_pending?.realizo === '1'">
                  <button *ngIf="pending?.student_pending?.exam_estudent" nbButton size="small" status="primary"
                          (click)="verEvaluacion()">Ver evaluación
                  </button>
                </div>
              </div>
              <div *ngIf="pending?.exam?.supervisado === 'PROCTORIZER'">
                <div
                  *ngIf="rolSemestre?.rol?.name === 'Estudiante' && pending && pending?.validaciones?.bloqueo === 0 && pending?.student_pending?.realizo !== '1'">
              <span *ngIf="!pending?.student_pending?.exam_estudent && ValidateDateI === true" class="text-center" style="color: var(--color-danger-500); font-size: 11px;padding: 0px;"><strong class="text-center">¿Estás seguro de iniciar el examen?</strong><br>
              <label class="text-center">Si su respuesta es “sí”, ya no habrá oportunidad de volver a realizar este examen.</label>
              </span> <br><br>
                  <button *ngIf="pending?.student_pending?.exam_estudent === null && ValidateDateI === true" nbButton size="small" status="primary"
                          (click)="initEvaluationsSupervisado()">Iniciar evaluación supervisada
                  </button>
                  <button *ngIf="pending?.student_pending?.exam_estudent" nbButton size="small" status="primary"
                          (click)="backQuestions()">Volver a la evaluación
                  </button>
                </div>
                <div
                  *ngIf="rolSemestre?.rol?.name === 'Estudiante' && pending && pending?.student_pending?.realizo === '1'">
                  <button *ngIf="pending?.student_pending?.exam_estudent" nbButton size="small" status="primary"
                          (click)="verEvaluacion()">Ver evaluación
                  </button>
                </div>
              </div>

            </nb-card-footer>
          </nb-card>
        </div>
        <div class="col-md-2"></div>
      </div>
    </nb-card-body>
  </nb-card>
</div>
