<div class="perfil-container" [nbSpinner]="loading"
     nbSpinnerStatus="primary"
     nbSpinnerSize="small">
  <div class="profile mb-1">
    <div class="photo-container">
      <!-- <img src="assets/student.jpg" alt=""> -->
      <img [src]="profile?.user?.profile_photo_url" [alt]="" width="100%" style="object-fit: contain" />
    </div>
    <div class="d-flex flex-column" style="flex: 1">
      <div class="student">
        <p class="student-name">
          {{profile?.user?.person?.nombres}}
        </p>
        <p class="student-lastname">
          {{profile?.user?.person?.apellido_paterno}} {{profile?.user?.person?.apellido_materno}}
        </p>
      </div>
      <div class="student-info">
        <p *ngIf="rolSemestre?.rol?.name === 'Estudiante'" class="ciclo">{{ profile?.user?.person?.ciclo }}º Ciclo</p>
        <p *ngIf="rolSemestre?.rol?.name === 'Estudiante'" class="carrera">{{ profile?.user?.person?.programa_estudio }}</p>
        <p class="codigo">
          {{ profile?.user?.person?.codigo }}
        </p>
      </div>
    </div>
  </div>
  <div class="stats-ciclo">
    <div class="asignaturas">
      <nb-icon icon="book-open"></nb-icon>
      <p>{{ profile?.info?.total_cursos }}</p>
      <span>Asignaturas en este ciclo</span>
    </div>
    <div class="avance">
      <nb-icon icon="activity"></nb-icon>
      <p>{{ profile?.info?.avance_academico }}%</p>
      <span>Avance Académico</span>
    </div>
    <div class="promedio">
      <nb-icon icon="award"></nb-icon>
      <p>{{ profile?.info?.promedio_ciclo }}</p>
      <span>Promedio en este ciclo</span>
    </div>
  </div>
  <div class="chart-stats">
    <div style="display: block; width: 150px; height: 150px">
      <canvas baseChart
              [data]="doughnutChartData"
              [labels]="doughnutChartLabels"
              [type]="doughnutChartType"
              [legend]="true"
              [options]="doughnutChartOptions"
      >
      </canvas>
    </div>
    <!-- <app-chart-trabajos [progressDatos]="profile?.info"></app-chart-trabajos> -->
    <div class="description">
      <p>{{ profile?.info?.total_trabajos }}</p>
      <span>Evaluciones en total</span>
      <ul>
        <li>
          <span style="background-color: #FFD372"></span><small>{{ profile?.info?.trabajos_por_completar }} Evaluciones por completar</small>
        </li>
        <li>
          <span  style="background-color: #FF6961"></span><small>{{ profile?.info?.trabajos_vencidos }} Evaluciones vencidos</small>
        </li>
        <li>
          <span style="background-color: #8CFCA4"></span><small>{{ profile?.info?.trabajos_completados }} Evaluciones completados</small>
        </li>
      </ul>
    </div>
  </div>
  <div class="trabajos">
    <div class="completados work">
      <div class="count">
        <p>{{ profile?.info?.resumen_por_tipo[0]?.examenes?.realizo }}</p>
        <span>/ {{ profile?.info?.resumen_por_tipo[0]?.examenes?.total }}</span>
      </div>
      <div class="description">
        <div class="text">
          <p>Exámenes</p>
          <nb-progress-bar class="exam-progress"  [value]="(profile?.info?.resumen_por_tipo[0]?.examenes?.realizo / profile?.info?.resumen_por_tipo[0]?.examenes?.total) * 100"></nb-progress-bar>
        </div>
      </div>
    </div>
    <div class="vencidos work">
      <div class="count">
        <p>{{ profile?.info?.resumen_por_tipo[0]?.foros?.realizo }}</p>
        <span>/ {{ profile?.info?.resumen_por_tipo[0]?.foros?.total }}</span>
      </div>
      <div class="description">
        <div class="text">
          <p>Foros</p>
          <nb-progress-bar class="forum-progress" [value]="(profile?.info?.resumen_por_tipo[0]?.foros?.realizo / profile?.info?.resumen_por_tipo[0]?.foros?.total) * 100"></nb-progress-bar>
        </div>
      </div>
    </div>
    <div class="por-completar work">
      <div class="count">
        <p>{{ profile?.info?.resumen_por_tipo[0]?.trabajos?.realizo }}</p>
        <span>/ {{ profile?.info?.resumen_por_tipo[0]?.trabajos?.total }}</span>
      </div>
      <div class="description">
        <div class="text">
          <p>Trabajos</p>
          <nb-progress-bar class="works-progress" [value]="(profile?.info?.resumen_por_tipo[0]?.trabajos?.realizo / profile?.info?.resumen_por_tipo[0]?.trabajos?.total) * 100"></nb-progress-bar>
        </div>
      </div>
    </div>
  </div>

  <div class="options" *ngIf="rolSemestre?.rol?.name === 'Admin'">
    <div class="title-name">
      <small>CONFIGURACIÓN</small>
    </div>

      <div class="d-flex flex-column">
        <div class="d-flex justify-content-between align-items-center items" >
          <small>Editar perfil</small>
          <button nbButton status="primary" size="tiny" style="margin-left: 20px" (click)="editUser()"><nb-icon icon="edit"></nb-icon></button>
        </div>
        <hr style="margin: 0 15px">
        <div class="d-flex justify-content-between align-items-center items">
          <small>Sincronizar Matrícula</small>
          <button nbButton status="primary" size="tiny" style="margin-left: 20px" (click)="matriculaByStudent()"><nb-icon icon="sync-outline"></nb-icon></button>
        </div>
        <hr style="margin: 0 15px">
        <div class="d-flex justify-content-between align-items-center items">
          <small>Sincronizar cursos</small>
          <button nbButton status="primary" size="tiny" style="margin-left: 20px" (click)="sincCourse()"><nb-icon icon="sync-outline"></nb-icon></button>
        </div>
        <hr style="margin: 0 15px">
        <div class="d-flex justify-content-between align-items-center items">
          <small>Sincronizar datos</small>
          <button nbButton status="primary" size="tiny" style="margin-left: 20px" (click)="sincronizarDatos()"><nb-icon icon="sync-outline"></nb-icon></button>
        </div>
      </div>
    <br>
      <button nbButton status="warning" size="small" fullWidth style="margin: 0" (click)="simularUsuario()" *ngIf="userSimulate === null">Simular usuario</button>
  </div>
  <!--<div class="stats-percentage">
    <div class="participacion">
      <div class="description">
        <p>Participación</p>
        <span>Ciclo: {{ profile?.person?.ciclo }} - Campus: Lima</span>
      </div>
      <div class="percentage">
        <p>{{ profile?.info?.participation }}%</p>
      </div>
    </div>
    <div class="asistencia">
      <div class="description">
        <p>Asistencia</p>
        <span>Ciclo: {{ profile?.person?.ciclo }} - Campus: Lima</span>
      </div>
      <div class="percentage">
        <p>90%</p>
      </div>
    </div>
    <div class="evaluacion">
      <div class="description">
        <p>Evaluación</p>
        <span>Ciclo: {{ profile?.person?.ciclo }} - Campus: Lima</span>
      </div>
      <div class="percentage">
        <p>85%</p>
      </div>
    </div>
  </div>-->
</div>
